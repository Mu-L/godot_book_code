[gd_scene load_steps=15 format=3 uid="uid://dq74u7xokhaw1"]

[ext_resource type="PackedScene" uid="uid://cjxhxbtxge7nj" path="res://Scenes/Maps/map_pcg.tscn" id="1_rfaor"]
[ext_resource type="PackedScene" uid="uid://cjx6mb7o8ct0u" path="res://Scenes/manager/vfx_manager.tscn" id="2_i8aot"]
[ext_resource type="PackedScene" uid="uid://dytfkbyld0eye" path="res://Scenes/UI/hud.tscn" id="3_it2as"]
[ext_resource type="PackedScene" uid="uid://bn2pi1eq1mvyp" path="res://Scenes/Player/player.tscn" id="4_jiu21"]
[ext_resource type="PackedScene" uid="uid://p3b0t7qx3ydr" path="res://Scenes/manager/enemy_manager.tscn" id="5_0g2at"]
[ext_resource type="PackedScene" uid="uid://coagmfmoo0dyg" path="res://Scenes/Enemy/enemy_tank.tscn" id="6_x0hct"]
[ext_resource type="PackedScene" uid="uid://bwk5b6hf5n83w" path="res://Scenes/Enemy/enemy_mis_vehicle.tscn" id="7_e2jqg"]
[ext_resource type="PackedScene" uid="uid://c0ymxelsqw38h" path="res://Scenes/Enemy/enemy_tower.tscn" id="8_aj407"]
[ext_resource type="PackedScene" uid="uid://divch0op1c52" path="res://Scenes/manager/pickup_manager.tscn" id="9_n4ld5"]
[ext_resource type="PackedScene" uid="uid://b0cjoaquis6w0" path="res://Scenes/manager/level_manager.tscn" id="13_ejxaj"]
[ext_resource type="Script" path="res://Scenes/game/canvas_modulate.gd" id="13_x1ie1"]

[sub_resource type="Shader" id="Shader_kc1t1"]
code = "shader_type canvas_item;

uniform bool active;
uniform vec3 flash_color : source_color = vec3(1.0);


void fragment(){
	vec4 t = texture(TEXTURE, UV);
	if (active == true) {
		COLOR = vec4(flash_color, t.a);
	}
	
}"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_lmlwl"]
resource_local_to_scene = true
shader = SubResource("Shader_kc1t1")
shader_parameter/active = false
shader_parameter/flash_color = Color(1, 1, 1, 1)

[sub_resource type="Environment" id="Environment_hfq0m"]
background_mode = 3
glow_enabled = true
glow_blend_mode = 1

[node name="Game" type="Node2D"]
metadata/_edit_horizontal_guides_ = [-3.0, 1470.0]
metadata/_edit_vertical_guides_ = [-2.0, 2947.0]

[node name="Points" type="Node2D" parent="."]

[node name="EnemyStart" type="Marker2D" parent="Points"]
position = Vector2(90, 536)

[node name="PlayerStart" type="Marker2D" parent="Points"]
position = Vector2(2834, 546)

[node name="TopLeft" type="Marker2D" parent="Points"]
position = Vector2(386, 237)

[node name="BottomRight" type="Marker2D" parent="Points"]
position = Vector2(2388, 1221)

[node name="MapPCG" parent="." node_paths=PackedStringArray("points") instance=ExtResource("1_rfaor")]
points = NodePath("../Points")
stone_count = 20

[node name="EnemiesHolder" type="Node2D" parent="."]

[node name="HUDLayer" type="CanvasLayer" parent="."]

[node name="HUD" parent="HUDLayer" instance=ExtResource("3_it2as")]

[node name="Player" parent="." node_paths=PackedStringArray("points", "map") instance=ExtResource("4_jiu21")]
material = SubResource("ShaderMaterial_lmlwl")
position = Vector2(779, 546)
rotation = 3.14159
points = NodePath("../Points")
map = NodePath("../MapPCG")

[node name="VFXManager" parent="." instance=ExtResource("2_i8aot")]

[node name="PickupManager" parent="." instance=ExtResource("9_n4ld5")]

[node name="EnemyManager" parent="." node_paths=PackedStringArray("map", "enemies_holder") instance=ExtResource("5_0g2at")]
enemy_tank_scene = ExtResource("6_x0hct")
enemy_mis_scene = ExtResource("7_e2jqg")
enemy_tower_scene = ExtResource("8_aj407")
map = NodePath("../MapPCG")
enemies_holder = NodePath("../EnemiesHolder")

[node name="LevelManager" parent="." node_paths=PackedStringArray("enemy_manager", "map") instance=ExtResource("13_ejxaj")]
enemy_manager = NodePath("../EnemyManager")
map = NodePath("../MapPCG")

[node name="CanvasModulate" type="CanvasModulate" parent="."]
color = Color(0.494118, 0.298039, 0.411765, 1)
script = ExtResource("13_x1ie1")
map_colors = Array[Color]([Color(0.4, 0.588235, 0.729412, 1), Color(0.890196, 0.890196, 0.545098, 1), Color(0.909804, 0.643137, 0.32549, 1), Color(0.494118, 0.298039, 0.411765, 1), Color(0.164706, 0.160784, 0.396078, 1)])

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_hfq0m")
